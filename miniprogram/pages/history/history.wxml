<!--pages/history/history.wxml-->
<view class="container">
  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-card card">
    <view class="stats-title">æ‰“å¡ç»Ÿè®¡</view>
    <view class="stats-content">
      <view class="stat-item">
        <text class="stat-number">{{totalCheckins}}</text>
        <text class="stat-label">æ€»æ‰“å¡æ¬¡æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{thisWeekCheckins}}</text>
        <text class="stat-label">æœ¬å‘¨æ‰“å¡</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{thisMonthCheckins}}</text>
        <text class="stat-label">æœ¬æœˆæ‰“å¡</text>
      </view>
    </view>
  </view>

  <!-- ç­›é€‰é€‰é¡¹ -->
  <view class="filter-card card">
    <view class="filter-title">ç­›é€‰æ¡ä»¶</view>
    <view class="filter-options">
      <button 
        class="filter-btn {{filterType === 'all' ? 'active' : ''}}"
        bindtap="setFilter"
        data-type="all"
      >
        å…¨éƒ¨
      </button>
      <button 
        class="filter-btn {{filterType === 'week' ? 'active' : ''}}"
        bindtap="setFilter"
        data-type="week"
      >
        æœ¬å‘¨
      </button>
      <button 
        class="filter-btn {{filterType === 'month' ? 'active' : ''}}"
        bindtap="setFilter"
        data-type="month"
      >
        æœ¬æœˆ
      </button>
    </view>
  </view>

  <!-- æ‰“å¡è®°å½•åˆ—è¡¨ -->
  <view class="history-list" wx:if="{{checkinHistory.length > 0}}">
    <view 
      class="history-item" 
      wx:for="{{checkinHistory}}" 
      wx:key="id"
      bindtap="viewDetail"
      data-item="{{item}}"
    >
      <view class="item-header">
        <view class="item-location">{{item.locationName}}</view>
        <view class="item-time">{{item.checkinTime}}</view>
      </view>
      <view class="item-address">{{item.locationAddress}}</view>
      <view class="item-footer">
        <view class="item-distance">{{item.distance}}ç±³</view>
        <view class="item-status success">å·²æ‰“å¡</view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <view class="empty-icon">ğŸ“</view>
    <view class="empty-text">æš‚æ— æ‰“å¡è®°å½•</view>
    <view class="empty-desc">å»åœ°å›¾é¡µé¢é€‰æ‹©åœ°ç‚¹å¼€å§‹æ‰“å¡å§ï¼</view>
    <button class="btn btn-primary" bindtap="goToMap">å»æ‰“å¡</button>
  </view>

  <!-- æ¸…ç©ºè®°å½•æŒ‰é’® -->
  <view class="clear-actions" wx:if="{{checkinHistory.length > 0}}">
    <button class="btn btn-secondary clear-btn" bindtap="clearHistory">
      æ¸…ç©ºæ‰€æœ‰è®°å½•
    </button>
  </view>
</view>
